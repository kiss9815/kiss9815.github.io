---
title: "AJP(Apache JServ Protocol)"
excerpt: "AJP(Apache JServ Protocol)"
categories:
  - apache
tags:
  - apache, web, ajp
last_modified_at: 2018-12-26T13:00:00+09:00
toc: true
toc_sticky: true
---

## 1. AJP(Apache JServ Protocol)와 mod_jk

AJP는 웹서버 뒤에 있는 어플리케이션 서버로부터 웹서버로 들어오는 요청을 위임할 수 있는 바이너리 프로콜입니다. 어플리케이션 서버로 핑을 할 수 있는 웹서버의 모니터링 기능을 지원한다.

웹개발자들은 대체로 AJP를 여러 웹서버로부터 여러개 어플리케이션 서버로의 로드밸런스 구현에 이용합니다. 세션들의 각각의 애플리케이션 서버 인스턴스의 이름을 갖는 라우팅 메커니즘을 사용하는 현재 어플리케이션 서버로 리다이렉트된다. 이 경우 어플리케이션 서버를 위한 리버스 프록시로 웹서버로 동작한다.

아파치와 톰캣이 연동하기 위해선 AJP를 통해 서로 통신을 하여야 합니다. AJP란, 아파치가 웹서버와 외부서비스(톰캣)을 연동하기 위해 정한 규약(프로토콜)이다. 아파치는 이를 사용하여 포트 80으로 들어오는 요청은 자신이 받고, 이 요청 중 서블릿을 필요로 하는 요청은 톰캣에 넘겨 처리한다.


아파치, 톰캣 연동을 위해 mod_jk라는 모듈을 사용하는데, 이는 AJP 프로토콜을 사용하여 톰캣과 연동하기 위해 만들어진 모듈이다. mod_jk는 톰캣의 일부로 배포되지만, 아파치 웹서버에 설치하여야 한다.

1. 아파치 웹서버의 httpd.conf에 톰캣 연동을 위한 설정을 추가하고 톰캣에서 처리할 요청을 지정.
2. 사용자의 브라우저는 아파치 웹서버(보통 포트 80)에 접속해 요청.
3. 아파치 웹서버는 사용자의 요청이 톰캣에서 처리하도록 지정된 요청인지 확인 후, 톰캣에서 처리해야 하는 경우 아파치 웹서버는 톰캣의 AJP포트(보통 8009포트)에 접속해 요청을 전달.
4. 톰캣은 아파치 웹서버로부터 요청을 받아 처리한 후, 처리 결과를 아파치 웹서버에 되돌려 준다.
5. 아파치 웹서버는 톰캣으로부터 받은 처리 결과를 사용자에게 전송.
